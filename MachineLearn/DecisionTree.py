import numpy as np
import matplotlib.pyplot as plt
from sklearn.tree import DecisionTreeClassifier, plot_tree

# 1. å‡†å¤‡æ•°æ®
# å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹æ•°æ®æ¥å†³å®šæ˜¯å¦â€œå»æ‰“çƒâ€
# ç‰¹å¾ (X): [å¤©æ°”, æ¸©åº¦, æ¹¿åº¦, é£åŠ›]
# ä¸ºäº†ç®€åŒ–ï¼Œæˆ‘ä»¬å°†æ–‡æœ¬ç‰¹å¾è½¬æ¢ä¸ºæ•°å­—ï¼š
# å¤©æ°”: æ™´å¤©=2, é˜´å¤©=1, é›¨å¤©=0
# æ¸©åº¦: ç‚çƒ­=2, æ¸©å’Œ=1, å‡‰çˆ½=0
# æ¹¿åº¦: é«˜=1, æ­£å¸¸=0
# é£åŠ›: å¼º=1, å¼±=0

# è®­ç»ƒæ•°æ®ç‰¹å¾
# æ¯è¡Œä»£è¡¨ä¸€ä¸ªæ ·æœ¬
X_train = np.array([
    [2, 2, 1, 0],  # æ™´å¤©, ç‚çƒ­, é«˜æ¹¿, æ— é£ -> ä¸å»
    [2, 2, 1, 1],  # æ™´å¤©, ç‚çƒ­, é«˜æ¹¿, æœ‰é£ -> ä¸å»
    [2, 0, 0, 1],  # æ™´å¤©, å‡‰çˆ½, æ­£å¸¸, æœ‰é£ -> å»
    [1, 2, 1, 0],  # é˜´å¤©, ç‚çƒ­, é«˜æ¹¿, æ— é£ -> å»
    [0, 1, 1, 0],  # é›¨å¤©, æ¸©å’Œ, é«˜æ¹¿, æ— é£ -> å»
    [0, 0, 0, 0],  # é›¨å¤©, å‡‰çˆ½, æ­£å¸¸, æ— é£ -> å»
    [0, 0, 0, 1],  # é›¨å¤©, å‡‰çˆ½, æ­£å¸¸, æœ‰é£ -> ä¸å»
    [1, 0, 0, 1]   # é˜´å¤©, å‡‰çˆ½, æ­£å¸¸, æœ‰é£ -> å»
])

# è®­ç»ƒæ•°æ®æ ‡ç­¾ (y)
# 1 ä»£è¡¨ "å»æ‰“çƒ", 0 ä»£è¡¨ "ä¸å»æ‰“çƒ"
y_train = np.array([0, 0, 1, 1, 1, 1, 0, 1])

# ç‰¹å¾å’Œç±»åˆ«çš„åç§°ï¼ˆç”¨äºå¯è§†åŒ–ï¼‰
feature_names = ['Weather', 'Temperature', 'Humidity', 'Wind']
class_names = ['Not Play', 'Play']


# 2. åˆ›å»ºå¹¶è®­ç»ƒæ¨¡å‹
# åˆ›å»ºä¸€ä¸ªå†³ç­–æ ‘åˆ†ç±»å™¨å®ä¾‹
# random_state=42 ä¿è¯æ¯æ¬¡è¿è¡Œç»“æœéƒ½ä¸€æ ·ï¼Œä¾¿äºå¤ç°
model = DecisionTreeClassifier(criterion='entropy', random_state=42)

# ä½¿ç”¨è®­ç»ƒæ•°æ®æ¥è®­ç»ƒæ¨¡å‹
model.fit(X_train, y_train)

print("âœ… å†³ç­–æ ‘æ¨¡å‹è®­ç»ƒå®Œæˆ!")


# 3. è¿›è¡Œé¢„æµ‹
# å‡è®¾ä»Šå¤©çš„å¤©æ°”æ˜¯ï¼š[å¤©æ°”=æ™´å¤©(2), æ¸©åº¦=æ¸©å’Œ(1), æ¹¿åº¦=é«˜(1), é£åŠ›=æ— é£(0)]
new_data = np.array([[2, 1, 1, 0]])

# ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹
prediction = model.predict(new_data)
prediction_proba = model.predict_proba(new_data)

print(f"\nğŸ¤” æ–°æ•°æ®: {new_data[0]}")
print(f"ğŸ¯ é¢„æµ‹ç»“æœ: {class_names[prediction[0]]} (åŸå§‹å€¼: {prediction[0]})")
print(f"ğŸ“Š é¢„æµ‹æ¦‚ç‡ [ä¸å», å»]: {prediction_proba[0]}")


# 4. å¯è§†åŒ–å†³ç­–æ ‘
# åˆ›å»ºä¸€ä¸ªå›¾å½¢æ¥å±•ç¤ºå†³ç­–æ ‘
plt.figure(figsize=(12, 8))
plot_tree(
    model,
    filled=True, # ç”¨é¢œè‰²å¡«å……èŠ‚ç‚¹
    feature_names=feature_names,
    class_names=class_names,
    rounded=True,
    fontsize=10
)
plt.title("Decision Tree for Playing Tennis")
plt.show()